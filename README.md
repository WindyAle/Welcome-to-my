# Well... come to my Home 😒
<img width="656" height="480" alt="background" src="https://github.com/user-attachments/assets/b6b36ecd-4c13-4eb5-8232-ea9766903ff7" />

LLM 기반 인테리어 배치 게임

인테리어 전문가가 되어 고객이 원하는 방을 만들어주세요!

## 💡 주요 컨셉

LLM에게 공간의 개념 이해시키기

- 내가 만든 방의 형태를 언어 모델이 이해할 수 있을까?

## 🕹️ 게임 방법

### 1. 고객 의뢰 (LLM)

- 모델이 무작위 페르소나(직업, 성격, 취향)를 기반으로 고객이 되어 인테리어 의뢰서를 제공한다.
- '고객'은 마음 속으로 **원하는** 가구가 있다.
- 고객은 자신이 원하는 것을 **모호하게** 설명한다.
    - 예: 책장 → "책 읽는 걸 좋아해요"

### 2. 가구 배치 (Human)

- 플레이어는 고객의 모호한 의뢰를 보고 적절한 가구를 적절하게 배치한다.

### 3. 디자인 평가 (LLM)

- 가구의 배치 상태를 설명하는 **설명 문장**을 내부적으로 생성
- LLM에게 맨 처음의 의뢰서와 설명 문장을 프롬프트로 주어 비교 

### 4. 상세 피드백 (LLM)
점수와 함께 LLM이 날카로운 피드백을 돌려준다.

- 이때 LLM이 처음 정해둔 '원하는 가구'를 공개하여 피드백 근거로 활용한다.
    - 예: "제 지식을 보관할 선반이 빠져있어서 아쉽네요."

## 💯 디자인 평가 요소
피드백 생성 전, 내부 함수를 통해 **3가지 사실(fact)** 추출 후 피드백 근거로 반환

- **배치된 가구**
    - **어떤** 가구가 있는가?
    - 고객이 원하던 특정 가구를 캐치하지 못했다면 감점 위험
- **가구의 위치**
    - **어디에** 가구가 있는가?
    - 가구의 좌표를 계산하여 가구의 위치를 LLM이 파악
        - "문 앞에 침대는 좀 아니지 않나요?"
- **공간 밀도**
    - **어떻게** 가구가 있는가?
    - 방 안에 가구가 밀집되어 있는지 혹은 너무 휑한지
        - 전체 칸 수 대비 오브젝트가 놓인 칸 수 비율
        - "중앙이 너무 넓어요"

1. `evaluation.py`의 `_get_design_facts` 함수가 fact들을 수집
2. 그 반환값을 `describe_design` 함수가 받아 디자인을 설명하는 문장을 얻어냄
3. 정보를 취합하여 generate_feedback 함수가 피드백을 생성 (플레이어가 보게 되는 내용)

## 💬 주요 프롬프팅
- 고객 의뢰서 생성: **백파이어(Backfire)** 유발
    - 원하는 가구를 정해놓지만 그것을 노출하면 안됨
    - 가구 목록을 프롬프트로 제공해주고, 그것을 금지시킴
    - LLM 특성상 제공된 정보를 완전히 배제하지 못하므로 이것을 '모호함' 생성으로 역이용
 
- 고객 피드백 생성: 역할극 및 **LLM-as-a-Judge** 기법 활용
    - "당신은 LLM의 성능을 평가하는 테스터"라는 역할을 부여
    - LLM을 평가하는 LLM을 중간에 투입하여 평점 산정을 보조
 
- (기각된 방법) **코사인 유사도**
    - 가구를 어떻게 배치해도 평점이 4~5점의 고득점만 나오는 현상에서 발견
    - 의미가 아닌 유사성과 빈도 기반의 비교이므로 현 프로젝트에 맞지 않음
    - 소파와 침대 → 어휘적으로는 가까운 단어지만 이 게임에서는 서로 달라야 함

## 🛠️ 기술 스택
- Game Client: PyGame
- LLM Provider: Ollama
- LLM Hosting: RunPod (Ollama 서버 실행)
- Model: EEVE-Korean-10.8B
- Language: Python 3.12

## 🔎 참고 작품
- 심즈 4
- 스타듀밸리
- GatherTown

## 🗃️ 애셋

- **Itch.io**
    - [Top-Down Retro Interior by Penzilla](https://penzilla.itch.io/top-down-retro-interior)
    - [Modern Interiors by Limezu](https://limezu.itch.io/moderninteriors)
